import mlptrain as mlt
import pytest
from autode.atoms import Atom


@pytest.fixture
def h2():
    """Dihydrogen molecule"""
    atoms = [
        Atom('H', -0.80952, 2.49855, 0.0),
        Atom('H', -0.34877, 1.961, 0.0),
    ]
    return mlt.Molecule(atoms=atoms, charge=0, mult=1)


@pytest.fixture
def h2o():
    """Water molecule"""
    atoms = [
        Atom('H', 2.32670, 0.51322, 0.0),
        Atom('H', 1.03337, 0.70894, -0.89333),
        Atom('O', 1.35670, 0.51322, 0.0),
    ]
    return mlt.Molecule(atoms=atoms, charge=0, mult=1)


@pytest.fixture
def h2_configuration(h2):
    system = mlt.System(h2, box=[50, 50, 50])
    config = system.random_configuration()

    return config


@pytest.fixture
def h2o_configuration(h2o):
    system = mlt.System(h2o, box=[50, 50, 50])
    config = system.random_configuration()

    return config


@pytest.fixture
def h2o_solvated_with_h2o():
    """Water molecule solvated with water with default
    solvation settings, water solvent specified by name"""
    atoms = [
        Atom('H', 6.726, 5.781, 5.842),
        Atom('H', 5.432, 5.977, 4.949),
        Atom('O', 5.756, 5.781, 5.842),
        Atom('O', 9.728, 8.795, 4.904),
        Atom('H', 9.786, 8.277, 4.098),
        Atom('H', 10.623, 9.047, 5.142),
        Atom('O', 1.532, 9.875, 8.858),
        Atom('H', 1.836, 9.259, 9.528),
        Atom('H', 1.665, 9.453, 8.006),
        Atom('O', 2.569, 11.176, 1.462),
        Atom('H', 3.147, 11.078, 2.223),
        Atom('H', 3.009, 10.758, 0.719),
        Atom('O', 7.553, 8.163, 11.117),
        Atom('H', 7.634, 7.851, 10.213),
        Atom('H', 6.746, 7.786, 11.475),
        Atom('O', 4.367, 3.438, 5.371),
        Atom('H', 3.798, 3.04, 6.033),
        Atom('H', 4.173, 4.377, 5.359),
        Atom('O', 10.41, 2.639, 9.368),
        Atom('H', 10.723, 2.227, 8.56),
        Atom('H', 10.392, 1.958, 10.043),
        Atom('O', 9.935, 7.466, 8.257),
        Atom('H', 10.195, 7.878, 7.43),
        Atom('H', 9.899, 6.52, 8.102),
        Atom('O', 11.474, 6.106, 3.41),
        Atom('H', 10.928, 6.285, 2.642),
        Atom('H', 10.937, 5.604, 4.027),
        Atom('O', 10.573, 1.4, 4.175),
        Atom('H', 11.12, 1.167, 3.423),
        Atom('H', 10.827, 0.823, 4.899),
        Atom('O', 8.178, 3.761, 3.434),
        Atom('H', 7.77, 3.907, 2.578),
        Atom('H', 7.599, 4.149, 4.093),
        Atom('O', 9.031, 7.817, 1.143),
        Atom('H', 8.588, 7.46, 1.916),
        Atom('H', 9.004, 7.14, 0.464),
        Atom('O', 7.808, 1.216, 5.215),
        Atom('H', 8.32, 0.447, 5.476),
        Atom('H', 7.932, 1.33, 4.271),
        Atom('O', 7.764, 4.918, 9.768),
        Atom('H', 8.648, 4.71, 10.079),
        Atom('H', 7.625, 4.419, 8.96),
        Atom('O', 0.652, 6.421, 10.208),
        Atom('H', 0.098, 6.663, 10.953),
        Atom('H', 0.121, 6.525, 9.416),
        Atom('O', 9.716, 11.58, 5.809),
        Atom('H', 9.046, 11.215, 5.228),
        Atom('H', 10.108, 10.845, 6.286),
        Atom('O', 3.662, 6.499, 8.631),
        Atom('H', 3.94, 7.2, 9.224),
        Atom('H', 3.818, 6.808, 7.736),
        Atom('O', 6.095, 9.883, 4.723),
        Atom('H', 6.684, 9.915, 5.48),
        Atom('H', 6.632, 10.032, 3.942),
        Atom('O', 0.443, 6.44, 0.499),
        Atom('H', 0.654, 5.504, 0.488),
        Atom('H', 1.257, 6.915, 0.32),
        Atom('O', 6.313, 10.446, 0.976),
        Atom('H', 6.331, 9.489, 1.04),
        Atom('H', 5.398, 10.719, 1.067),
        Atom('O', 2.566, 0.617, 6.96),
        Atom('H', 3.444, 0.311, 6.722),
        Atom('H', 2.429, 1.456, 6.515),
        Atom('O', 5.823, 1.226, 0.049),
        Atom('H', 4.931, 1.47, 0.303),
        Atom('H', 6.065, 0.459, 0.572),
        Atom('O', 10.063, 3.649, 6.767),
        Atom('H', 9.946, 2.721, 6.978),
        Atom('H', 10.373, 3.696, 5.86),
        Atom('O', 10.838, 2.843, 1.233),
        Atom('H', 10.199, 2.133, 1.136),
        Atom('H', 10.603, 3.329, 2.026),
        Atom('O', 4.322, 1.398, 2.924),
        Atom('H', 3.809, 2.176, 2.696),
        Atom('H', 4.2, 1.244, 3.863),
        Atom('O', 4.885, 6.677, 0.994),
        Atom('H', 5.401, 7.454, 1.218),
        Atom('H', 4.777, 6.675, 0.04),
        Atom('O', 6.16, 7.382, 3.646),
        Atom('H', 6.388, 7.578, 2.735),
        Atom('H', 5.431, 7.958, 3.885),
        Atom('O', 2.629, 1.276, 0.427),
        Atom('H', 2.994, 0.407, 0.248),
        Atom('H', 1.947, 1.164, 1.092),
        Atom('O', 6.292, 5.348, 0.635),
        Atom('H', 6.079, 5.125, 1.544),
        Atom('H', 6.644, 4.555, 0.225),
        Atom('O', 2.863, 4.529, 9.833),
        Atom('H', 3.316, 4.107, 9.1),
        Atom('H', 3.534, 4.79, 10.467),
        Atom('O', 0.934, 2.045, 9.88),
        Atom('H', 1.031, 1.479, 9.112),
        Atom('H', 1.787, 2.456, 10.037),
        Atom('O', 10.179, 9.377, 9.587),
        Atom('H', 9.727, 9.742, 10.35),
        Atom('H', 9.51, 9.192, 8.924),
        Atom('O', 5.515, 1.654, 8.874),
        Atom('H', 6.39, 2.04, 8.943),
        Atom('H', 5.053, 2.124, 8.176),
        Atom('O', 4.832, 10.85, 7.395),
        Atom('H', 4.439, 10.086, 7.822),
        Atom('H', 5.006, 10.606, 6.484),
        Atom('O', 0.899, 8.492, 3.477),
        Atom('H', 1.314, 9.344, 3.628),
        Atom('H', 1.211, 8.172, 2.628),
        Atom('O', 3.066, 6.636, 1.654),
        Atom('H', 3.235, 5.945, 2.298),
        Atom('H', 3.131, 6.235, 0.785),
        Atom('O', 3.637, 10.752, 10.274),
        Atom('H', 4.032, 10.143, 10.902),
        Atom('H', 2.73, 10.895, 10.551),
        Atom('O', 10.661, 7.58, 10.351),
        Atom('H', 9.867, 7.662, 10.884),
        Atom('H', 11.306, 7.102, 10.878),
        Atom('O', 1.72, 6.65, 3.864),
        Atom('H', 1.133, 6.186, 4.466),
        Atom('H', 1.471, 6.394, 2.974),
        Atom('O', 7.582, 8.072, 7.315),
        Atom('H', 7.402, 7.472, 8.042),
        Atom('H', 7.148, 8.902, 7.52),
        Atom('O', 0.018, 2.228, 1.323),
        Atom('H', 0.154, 2.484, 2.237),
        Atom('H', 0.609, 2.765, 0.789),
        Atom('O', 8.603, 1.667, 10.389),
        Atom('H', 8.218, 1.137, 11.09),
        Atom('H', 8.535, 1.157, 9.579),
        Atom('O', 0.537, 1.185, 4.663),
        Atom('H', 1.197, 1.844, 4.437),
        Atom('H', 0.991, 0.477, 5.124),
        Atom('O', 10.744, 9.697, 0.684),
        Atom('H', 10.322, 10.225, 0.003),
        Atom('H', 11.451, 9.204, 0.262),
        Atom('O', 9.344, 11.175, 1.765),
        Atom('H', 9.015, 10.798, 2.584),
        Atom('H', 8.58, 11.382, 1.222),
        Atom('O', 0.78, 5.456, 6.58),
        Atom('H', 0.721, 4.875, 7.341),
        Atom('H', 1.659, 5.35, 6.211),
        Atom('O', 1.818, 8.899, 0.982),
        Atom('H', 1.875, 8.882, 0.024),
        Atom('H', 2.711, 9.008, 1.316),
        Atom('O', 6.238, 3.966, 10.706),
        Atom('H', 6.325, 3.572, 11.577),
        Atom('H', 5.841, 4.831, 10.827),
        Atom('O', 0.67, 8.419, 6.327),
        Atom('H', 0.424, 9.298, 6.035),
        Atom('H', 0.134, 8.217, 7.097),
        Atom('O', 3.694, 8.098, 5.155),
        Atom('H', 3.669, 7.681, 4.291),
        Atom('H', 3.224, 7.52, 5.76),
        Atom('O', 0.625, 11.226, 3.427),
        Atom('H', 1.102, 11.098, 2.604),
        Atom('H', 1.279, 11.374, 4.113),
        Atom('O', 11.096, 4.668, 10.993),
        Atom('H', 11.163, 4.244, 10.135),
        Atom('H', 10.305, 5.21, 10.979),
        Atom('O', 9.115, 6.37, 5.042),
        Atom('H', 8.775, 6.257, 5.932),
        Atom('H', 8.373, 6.275, 4.442),
    ]
    return mlt.Molecule(atoms=atoms, charge=0, mult=1)


@pytest.fixture
def mg():
    "Magnesium cation 2+"
    atoms = [
        Atom('Mg', 0.0, 0.0, 0.0),
    ]
    return mlt.Molecule(atoms=atoms, charge=+2, mult=1)


@pytest.fixture
def oh_radical():
    "OH radiacal species"
    atoms = [
        Atom('O', 1.35670, 0.51322, 0.0),
        Atom('H', 2.32670, 0.51322, 0.0),
    ]
    return mlt.Molecule(atoms=atoms, charge=0, mult=2)

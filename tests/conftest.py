import mlptrain as mlt
import pytest
from autode.atoms import Atom


@pytest.fixture
def h2():
    """Dihydrogen molecule"""
    atoms = [
        Atom('H', -0.80952, 2.49855, 0.0),
        Atom('H', -0.34877, 1.961, 0.0),
    ]
    return mlt.Molecule(atoms=atoms, charge=0, mult=1)


@pytest.fixture
def h2o():
    """Water molecule"""
    atoms = [
        Atom('H', 2.32670, 0.51322, 0.0),
        Atom('H', 1.03337, 0.70894, -0.89333),
        Atom('O', 1.35670, 0.51322, 0.0),
    ]
    return mlt.Molecule(atoms=atoms, charge=0, mult=1)


@pytest.fixture
def h2_configuration(h2):
    system = mlt.System(h2, box=[50, 50, 50])
    config = system.random_configuration()

    return config


@pytest.fixture
def h2o_configuration(h2o):
    system = mlt.System(h2o, box=[50, 50, 50])
    config = system.random_configuration()

    return config


@pytest.fixture
def h2o_solvated_with_h2o():
    """Water molecule solvated with water with default
    solvation settings, water solvent specified by name"""
    atoms = [
        Atom('H', 6.726, 5.781, 5.842),
        Atom('H', 5.432, 5.977, 4.949),
        Atom('O', 5.756, 5.781, 5.842),
        Atom('O', 2.626, 8.51, 7.795),
        Atom('H', 2.298, 9.408, 7.873),
        Atom('H', 2.228, 8.0, 8.503),
        Atom('O', 6.249, 2.553, 6.82),
        Atom('H', 6.871, 1.959, 6.394),
        Atom('H', 6.761, 3.159, 7.359),
        Atom('O', 8.063, 3.891, 1.832),
        Atom('H', 8.541, 3.869, 1.0),
        Atom('H', 8.024, 4.809, 2.111),
        Atom('O', 11.28, 4.326, 6.371),
        Atom('H', 11.258, 4.569, 7.299),
        Atom('H', 11.163, 5.133, 5.865),
        Atom('O', 6.645, 8.208, 0.523),
        Atom('H', 6.535, 7.28, 0.303),
        Atom('H', 7.528, 8.31, 0.884),
        Atom('O', 2.68, 1.112, 3.24),
        Atom('H', 2.218, 1.928, 3.438),
        Atom('H', 3.432, 1.339, 2.688),
        Atom('O', 2.368, 3.095, 10.826),
        Atom('H', 2.736, 3.686, 11.486),
        Atom('H', 3.051, 2.459, 10.605),
        Atom('O', 8.396, 1.882, 4.358),
        Atom('H', 8.633, 1.388, 5.146),
        Atom('H', 9.06, 2.565, 4.243),
        Atom('O', 7.986, 9.773, 8.96),
        Atom('H', 7.804, 9.885, 9.895),
        Atom('H', 7.17, 9.487, 8.545),
        Atom('O', 4.567, 10.584, 5.254),
        Atom('H', 5.424, 10.425, 5.656),
        Atom('H', 3.993, 10.928, 5.942),
        Atom('O', 5.951, 1.066, 0.507),
        Atom('H', 5.911, 0.37, 1.166),
        Atom('H', 5.116, 1.536, 0.542),
        Atom('O', 4.896, 0.758, 4.361),
        Atom('H', 5.389, 1.05, 5.131),
        Atom('H', 4.301, 0.064, 4.653),
        Atom('O', 9.911, 0.116, 8.36),
        Atom('H', 10.251, 0.505, 7.552),
        Atom('H', 10.651, 0.028, 8.965),
        Atom('O', 3.11, 5.824, 2.069),
        Atom('H', 2.772, 5.184, 2.699),
        Atom('H', 2.399, 6.015, 1.452),
        Atom('O', 5.692, 0.816, 8.813),
        Atom('H', 5.161, 0.704, 8.021),
        Atom('H', 5.112, 0.672, 9.564),
        Atom('O', 2.493, 0.846, 7.323),
        Atom('H', 3.094, 0.451, 7.958),
        Atom('H', 2.93, 0.824, 6.469),
        Atom('O', 0.869, 2.786, 7.719),
        Atom('H', 0.453, 3.078, 8.533),
        Atom('H', 0.429, 1.976, 7.452),
        Atom('O', 6.646, 5.465, 9.144),
        Atom('H', 5.829, 5.956, 9.027),
        Atom('H', 6.916, 5.156, 8.277),
        Atom('O', 9.989, 6.416, 0.539),
        Atom('H', 10.368, 6.446, 1.42),
        Atom('H', 9.412, 5.65, 0.505),
        Atom('O', 10.768, 9.829, 1.875),
        Atom('H', 11.058, 9.776, 2.788),
        Atom('H', 9.814, 9.929, 1.886),
        Atom('O', 11.347, 9.342, 10.201),
        Atom('H', 10.868, 9.82, 9.522),
        Atom('H', 11.133, 9.755, 11.041),
        Atom('O', 3.49, 9.171, 2.651),
        Atom('H', 4.017, 9.68, 3.271),
        Atom('H', 3.768, 9.425, 1.769),
        Atom('O', 10.71, 6.181, 8.306),
        Atom('H', 11.3, 6.346, 9.045),
        Atom('H', 10.326, 7.024, 8.058),
        Atom('O', 3.543, 3.584, 4.726),
        Atom('H', 3.02, 2.915, 5.173),
        Atom('H', 2.929, 4.227, 4.364),
        Atom('O', 5.436, 5.162, 2.481),
        Atom('H', 5.086, 4.798, 1.665),
        Atom('H', 4.901, 4.813, 3.197),
        Atom('O', 7.05, 2.541, 2.54),
        Atom('H', 6.587, 3.019, 3.231),
        Atom('H', 6.4, 2.304, 1.876),
        Atom('O', 4.396, 8.648, 9.644),
        Atom('H', 4.273, 9.288, 10.348),
        Atom('H', 4.44, 9.139, 8.82),
        Atom('O', 8.51, 3.155, 9.85),
        Atom('H', 8.355, 2.81, 10.732),
        Atom('H', 7.918, 2.688, 9.257),
        Atom('O', 2.822, 5.436, 7.106),
        Atom('H', 3.602, 4.899, 6.952),
        Atom('H', 2.1, 5.03, 6.62),
        Atom('O', 1.4, 2.243, 1.448),
        Atom('H', 0.747, 1.705, 0.995),
        Atom('H', 2.007, 2.57, 0.78),
        Atom('O', 0.612, 10.84, 5.537),
        Atom('H', 0.521, 11.366, 4.74),
        Atom('H', 0.405, 11.413, 6.278),
        Atom('O', 7.068, 8.581, 10.914),
        Atom('H', 6.343, 8.889, 11.463),
        Atom('H', 7.685, 8.127, 11.491),
        Atom('O', 8.099, 10.983, 5.808),
        Atom('H', 8.683, 10.563, 5.171),
        Atom('H', 7.628, 10.282, 6.263),
        Atom('O', 5.903, 3.134, 9.615),
        Atom('H', 6.508, 3.168, 10.359),
        Atom('H', 5.152, 3.689, 9.837),
        Atom('O', 9.674, 7.23, 10.446),
        Atom('H', 10.04, 7.923, 9.893),
        Atom('H', 9.978, 7.392, 11.341),
        Atom('O', 1.394, 11.174, 1.621),
        Atom('H', 0.958, 11.062, 2.468),
        Atom('H', 0.76, 10.931, 0.943),
        Atom('O', 5.78, 10.968, 0.478),
        Atom('H', 6.293, 10.184, 0.271),
        Atom('H', 6.279, 11.468, 1.127),
        Atom('O', 8.936, 8.391, 2.451),
        Atom('H', 8.818, 8.504, 3.397),
        Atom('H', 8.542, 7.549, 2.215),
        Atom('O', 11.275, 6.926, 4.073),
        Atom('H', 10.745, 7.133, 4.846),
        Atom('H', 10.791, 7.24, 3.306),
        Atom('O', 0.245, 10.755, 9.631),
        Atom('H', 0.581, 10.433, 8.792),
        Atom('H', 0.968, 11.207, 10.07),
        Atom('O', 3.288, 7.855, 5.7),
        Atom('H', 2.708, 8.463, 5.238),
        Atom('H', 3.74, 7.333, 5.033),
        Atom('O', 1.088, 7.893, 3.238),
        Atom('H', 1.038, 6.937, 3.311),
        Atom('H', 1.256, 8.234, 4.119),
        Atom('O', 6.417, 8.402, 6.106),
        Atom('H', 6.099, 8.935, 6.838),
        Atom('H', 5.673, 8.259, 5.517),
        Atom('O', 10.61, 0.65, 1.457),
        Atom('H', 10.186, 1.067, 0.704),
        Atom('H', 9.954, 0.089, 1.876),
        Atom('O', 2.376, 6.289, 10.827),
        Atom('H', 1.804, 5.758, 11.385),
        Atom('H', 2.317, 5.928, 9.939),
        Atom('O', 8.709, 5.457, 9.79),
        Atom('H', 8.316, 6.022, 10.459),
        Atom('H', 9.647, 5.399, 9.985),
        Atom('O', 9.01, 4.399, 6.125),
        Atom('H', 8.295, 5.009, 6.319),
        Atom('H', 9.248, 3.971, 6.95),
        Atom('O', 10.728, 10.473, 6.559),
        Atom('H', 10.653, 9.599, 6.948),
        Atom('H', 10.7, 10.361, 5.607),
        Atom('O', 10.954, 2.268, 3.657),
        Atom('H', 11.29, 2.958, 4.234),
        Atom('H', 10.961, 2.619, 2.764),
        Atom('O', 6.205, 7.075, 3.229),
        Atom('H', 6.33, 7.437, 2.349),
        Atom('H', 6.266, 7.807, 3.847),
        Atom('O', 0.343, 4.719, 5.289),
        Atom('H', 0.449, 3.766, 5.265),
        Atom('H', 0.542, 5.048, 4.41),
        Atom('O', 8.83, 0.49, 9.857),
        Atom('H', 8.124, 0.754, 9.263),
        Atom('H', 8.701, 0.969, 10.678),
    ]
    return mlt.Molecule(atoms=atoms, charge=0, mult=1)


@pytest.fixture
def mg():
    "Magnesium cation 2+"
    atoms = [
        Atom('Mg', 0.0, 0.0, 0.0),
    ]
    return mlt.Molecule(atoms=atoms, charge=+2, mult=1)


@pytest.fixture
def oh_radical():
    "OH radiacal species"
    atoms = [
        Atom('O', 1.35670, 0.51322, 0.0),
        Atom('H', 2.32670, 0.51322, 0.0),
    ]
    return mlt.Molecule(atoms=atoms, charge=0, mult=2)


@pytest.fixture
def empty_molecule():
    "No molecule inserted"
    molecule = mlt.Molecule()
    return molecule
